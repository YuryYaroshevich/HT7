<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC
        "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
        "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">

<hibernate-mapping package="com.epam.ht.entity.employee">
	<class name="Employee" table="Employee" lazy="false">
		<id name="id" column="EMPLOYEE_ID" type="long">
			<generator class="increment" />
		</id>
		<property name="firstName" column="FIRST_NAME" not-null="true" />
		<property name="lastName" column="LAST_NAME" not-null="true" />
		<many-to-one name="address" column="EMPLOYEE_ID" unique="true"
			not-null="true" class="com.epam.ht.entity.address.Address" insert="false"
			update="false" outer-join="true" />
		<set name="jobs" table="office_employee" lazy="false" outer-join="true">
			<key column="employee_id" />
			<many-to-many class="Position">
				<column name="office_id" />
				<column name="position" />
			</many-to-many>
		</set>
		<!-- <map name="jobs" table="OFFICE_EMPLOYEE" outer-join="true"> <key column="EMPLOYEE_ID" 
			/> <map-key-many-to-many column="OFFICE_ID" class="com.epam.ht.entity.office.Office" 
			/> <composite-element class="Position"> <property name="position" column="POSITION" 
			/> </composite-element> </map> -->

		<!-- <set name="jobs" table="OFFICE_EMPLOYEE" outer-join="true"> <key column="EMPLOYEE_ID" 
			/> <composite-element class="Position"> <property name="position" column="POSITION" 
			/> <many-to-many name="office" column="office_id" class="com.epam.ht.entity.office.Office" 
			/> </composite-element> </set> -->
	</class>

	<query name="query.EmployeeList">
		<![CDATA[from Employee emp left join fetch emp.jobs job
		                       left join fetch job.office office
		                       left join fetch office.company
	                           left join fetch office.address addr
		                       left join fetch addr.city c left join fetch c.country          
		                           left join fetch emp.address addr
		                           left join fetch addr.city c left join fetch c.country]]>
	</query>
	<query name="query.CorrespondOffices">
	    <![CDATA[from Office o left join fetch o.company
	                           left join fetch o.address addr
		                       left join fetch addr.city c left join fetch c.country
	                     where o.id in (:office_ids)]]>
	</query>
	<!-- <sql-query name="query.CorrespondOffices"> <![CDATA[select {off.*} 
		from office off left outer join company comp on comp.company_id = off.company_id 
		left outer join address addr on addr.address_id = off.address_id left outer 
		join city c on addr.city_id = c.city_id left outer join country coun on c.country_id 
		= coun.country_id where off.office_id in (select oe.office_id from office_employee 
		oe where oe.employee_id in(:employeeIds))]]> <return alias="off" class="com.epam.ht.entity.office.Office" 
		/> </sql-query> -->
</hibernate-mapping>